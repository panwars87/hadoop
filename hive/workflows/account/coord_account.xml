<coordinator-app name="coord_account"
                 frequency="${coord:days(1)}"
                 start="${initial}"
                 end="${coordEndDate}"
                 timezone="EST"
                 xmlns="uri:oozie:coordinator:0.1"
                 xmlns:sla="uri:oozie:sla:0.1">
    <controls>
        <timeout>2</timeout>
        <concurrency>1</concurrency>
    </controls>
    <datasets>
        <dataset name="account" frequency="${coord:days(1)}" initial-instance="${initial}" timezone="UTC">
            <uri-template>${incoming}/newdataset/ingest_date=${YEAR}-${MONTH}-${DAY}/</uri-template>
            <done-flag>_success</done-flag>
        </dataset>
        <dataset name="nominaldate" frequency="${coord:days(1)}" initial-instance="${initial}" timezone="UTC">
            <uri-template>${YEAR}-${MONTH}-${DAY}</uri-template>
        </dataset>
    </datasets>
    <input-events>
        <data-in name="input" dataset="account">
            <instance>${coord:current(0)}</instance>
        </data-in>
    </input-events>
    <output-events>
        <data-out name="nominaldate" dataset="nominaldate">
            <instance>${coord:current(0)}</instance>
        </data-out>
    </output-events>
    <action>
        <workflow>
            <!-- Workflow xml file path, workflow root directory is the path of workflow components-->
            <app-path>${workflowRoot}/account/wf_account.xml</app-path>
            <configuration>
                <property>
                    <name>rootDir</name>
                    <value>${workflowRoot}/account/</value>
                </property>
                <property>
                    <name>incoming</name>
                    <value>${incoming}</value>
                </property>
                <property>
                    <name>date</name>
                    <value>${coord:dataOut('nominaldate')}</value>
                </property>
                <property>
                    <name>notificationEmail</name>
                    <value>${notificationEmail}</value>
                </property>
                <property>
                    <name>envName</name>
                    <value>${envName}</value>
                </property>
                <property>
                    <name>cmhcdwdb</name>
                    <value>${cmhcdwdb}</value>
                </property>
                    <property>
                    <name>cmhstgcdwdb</name>
                    <value>${cmhstgcdwdb}</value>
                </property>
            </configuration>
        </workflow>
      <sla:info>
            <sla:app-name>account</sla:app-name>
            <sla:nominal-time>${coord:nominalTime()}</sla:nominal-time>
            <sla:should-start>${HOURS}</sla:should-start>
            <sla:should-end>${24*HOURS}</sla:should-end>
            <sla:notification-msg>Account data not available</sla:notification-msg>
            <sla:alert-contact>${notificationEmail}</sla:alert-contact>
            <sla:dev-contact>${notificationEmail}</sla:dev-contact>
            <sla:qa-contact>${notificationEmail}</sla:qa-contact>
            <sla:se-contact>${notificationEmail}</sla:se-contact>
            <sla:upstream-apps></sla:upstream-apps>
        </sla:info>
    </action>
</coordinator-app>
